<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Creates an experimental design given a model, desired number of runs, and a data frame of candidate
test points. gen_design chooses points from the candidate set and returns a design that is optimal for the given
statistical model."><title>Generate optimal experimental designs — gen_design • skpr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate optimal experimental designs — gen_design"><meta property="og:description" content="Creates an experimental design given a model, desired number of runs, and a data frame of candidate
test points. gen_design chooses points from the candidate set and returns a design that is optimal for the given
statistical model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">skpr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tylermorganwall/skpr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Generate optimal experimental designs</h1>
      <small class="dont-index">Source: <a href="https://github.com/tylermorganwall/skpr/blob/HEAD/R/gen_design.R" class="external-link"><code>R/gen_design.R</code></a></small>
      <div class="d-none name"><code>gen_design.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates an experimental design given a model, desired number of runs, and a data frame of candidate
test points. <code>gen_design</code> chooses points from the candidate set and returns a design that is optimal for the given
statistical model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gen_design</span><span class="op">(</span></span>
<span>  <span class="va">candidateset</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">trials</span>,</span>
<span>  splitplotdesign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  blocksizes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  optimality <span class="op">=</span> <span class="st">"D"</span>,</span>
<span>  augmentdesign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repeats <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  custom_v <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  varianceratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  contrast <span class="op">=</span> <span class="va">contr.simplex</span>,</span>
<span>  aliaspower <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  minDopt <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  k <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_blocking_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  randomized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  advancedoptions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  timer <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>candidateset</dt>
<dd><p>A data frame of candidate test points; each run of the optimal design will be chosen (with replacement)
from this candidate set. Each row of the data frame is a candidate test point. Each row should be unique.
Usually this is a full factorial test matrix generated for the factors in the model unless there are disallowed combinations of runs.
Factors present in the candidate set but not present in the model are stripped out, and the duplicate entries in the candidate set are removed.
Disallowed combinations can be specified by simply removing them from the candidate set. Disallowed combinations between a
hard-to-change and an easy-to-change factor are detected by comparing an internal candidate set generated by the unique levels
present in the candidate set and the split plot design. Those points are then excluded from the search.
If a factor is continuous, its column should be type <code>numeric</code>. If a factor is categorical, its column should be type <code>factor</code> or <code>character</code>.</p></dd>


<dt>model</dt>
<dd><p>The statistical model used to generate the test design.</p></dd>


<dt>trials</dt>
<dd><p>The number of runs in the design.</p></dd>


<dt>splitplotdesign</dt>
<dd><p>If `NULL`, a fully randomized design is generated. If not NULL, a split-plot design is generated, and
this argument specifies the design for all of the factors harder to change than the current set of factors.
Each row corresponds to a block in which the harder to change factors will be held
constant. Each row of <code>splitplotdesign</code> will be replicated as specified in <code>blocksizes</code>,
and the optimal design is found for all of the factors given in the
<code>model</code> argument, taking into consideration the fixed and replicated hard-to-change factors. If <code>blocksizes</code> is missing,
`gen_design` will attempt to allocate the runs in the most balanced design possible,
given the number of blocks given in the argument `splitplotdesign` and the total number of `trials`.</p></dd>


<dt>blocksizes</dt>
<dd><p>Default `NULL`. Specifies the block size(s) for design generation. If only one number is passed, `gen_design()`
will create blocks of the specified size, and if the total number of run specified in `trials` is not divisible by the number,
`gen_design()` will attempt to allocate the runs in the most balanced design possible. If a list is passed, each entry
in the list will specify an additional layer of blocking. If `splitplotdesign` is not `NULL`, this argument
specifies the number of subplots within each whole plot (each whole plot corresponding to a row in the `splitplotdesign` data.frame).</p></dd>


<dt>optimality</dt>
<dd><p>Default `D`. The optimality criterion used in generating the design. Full list of supported criteria: "D", "I", "A", "ALIAS", "G", "T", "E", or "CUSTOM". If "CUSTOM", user must also
define a function of the model matrix named `customOpt` in their namespace that returns a single value, which the algorithm will attempt to optimize. For
`CUSTOM` optimality split-plot designs, the user must instead define `customBlockedOpt`, which should be a function of the model matrix and the variance-covariance matrix. For
information on the algorithm behind Alias-optimal designs, see <em>Jones and Nachtsheim. "Efficient Designs With Minimal Aliasing." Technometrics, vol. 53, no. 1, 2011, pp. 62-71</em>.</p></dd>


<dt>augmentdesign</dt>
<dd><p>Default NULL. A `data.frame` of runs that are fixed during the optimal search process. The columns of `augmentdesign` must match those of the candidate set.
The search algorithm will search for the optimal `trials` - `nrow(augmentdesign)` remaining runs.</p></dd>


<dt>repeats</dt>
<dd><p>Default `20`. The number of times to repeat the search for the best optimal design.</p></dd>


<dt>custom_v</dt>
<dd><p>Default `NULL`. The user can pass a custom variance-covariance matrix to be used during blocked design generation.</p></dd>


<dt>varianceratio</dt>
<dd><p>Default `1`. The ratio between the block and run-to-run variance for a given stratum in
a split plot/blocked design. This requires a design passed into `splitplotdesign`, so it will be overridden to `1`
if no split plot design is entered.</p></dd>


<dt>contrast</dt>
<dd><p>Default `contr.simplex`, an orthonormal sum contrast. Function used to generate the encoding for categorical variables.</p></dd>


<dt>aliaspower</dt>
<dd><p>Default `2`. Degree of interactions to be used in calculating the alias matrix for alias optimal designs.</p></dd>


<dt>minDopt</dt>
<dd><p>Default `0.8`. Minimum value for the D-Optimality of a design when searching for Alias-optimal designs.</p></dd>


<dt>k</dt>
<dd><p>Default `NA`. For D-optimal designs, this changes the search to a k-exchange algorithm
<em>Johnson and Nachtsheim. "Some Guidelines for Constructing Exact D-Optimal Designs on Convex Design Spaces." Technometrics, vol. 25, 1983, pp. 271-277</em>.
This exchanges only the k lowest variance runs in the design at each search iteration. Lower numbers can result
in a faster search, but are less likely tofind an optimal design. Values of `k &gt;= n/4` have been shown empirically to generate similar designs to the full
search. When `k == trials`, this results in the default modified Federov's algorithm.
A `k` of 1 is a form of Wynn's algorithm <em>Wynn. "Results in the Theory and Construction of D-Optimum Experimental Designs," Journal of the Royal Statistical Society, Ser. B,vol. 34, 1972, pp. 133-14</em>.</p></dd>


<dt>parallel</dt>
<dd><p>Default `FALSE`. If `TRUE`, the optimal design search will use all but one of the available cores.
This can lead to a substantial speed-up in the search for complex designs. If the user wants to set the number of cores manually, they can do this by setting `options("cores")` to the desired number (e.g. `options("cores" = parallel::detectCores())`).
NOTE: If you have installed BLAS libraries that include multicore support (e.g. Intel MKL that comes with Microsoft R Open), turning on parallel could result in reduced performance.</p></dd>


<dt>progress</dt>
<dd><p>Default `TRUE`. Whether to include a progress bar.</p></dd>


<dt>add_blocking_columns</dt>
<dd><p>Default `FALSE`. The blocking structure of the design will be indicated in the row names of the returned
design. If `TRUE`, the design also will have extra columns to indicate the blocking structure. If no blocking is detected, no columns will be added.</p></dd>


<dt>randomized</dt>
<dd><p>Default `TRUE`, due to the intrinsic randomization of the design search algorithm. If `FALSE`,
the randomized design will be re-ordered from left to right.</p></dd>


<dt>advancedoptions</dt>
<dd><p>Default `NULL`. An named list for advanced users who want to adjust the optimal design algorithm parameters. Advanced option names
are `design_search_tolerance` (the smallest fractional increase below which the design search terminates), `alias_tie_power` (the degree of the aliasing
matrix when calculating optimality tie-breakers), `alias_tie_tolerance` (the smallest absolute difference in the optimality criterion where designs are
considered equal before considering the aliasing structure),  `alias_compare`` (which if set to FALSE turns off alias tie breaking completely),
`aliasmodel` (provided if the user does not want to calculate Alias-optimality using all `aliaspower` interaction terms),
and `progressBarUpdater`` (a function called in non-parallel optimal searches that can be used to update an external progress bar). Finally, there's
`g_efficiency_method`, which sets the method used to calculate G-efficiency (default is "random" for a random Monte Carlo sampling of the design space,
"optim" for to use simulated annealing, or "custom" to explicitly define the points in the design space, which is the fastest method
and the only way to calculate prediction variance with disallowed combinations). With this, there's also `g_efficiency_samples`, which specifies
the number of random samples  (default 1000 if `g_efficiency_method = "random"`), attempts at simulated annealing (default 1 if `g_efficiency_method = "optim"`),
or a data.frame defining the exact points of the design space if `g_efficiency_method = "custom"`.</p></dd>


<dt>timer</dt>
<dd><p>Deprecated: Use `progress` instead.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame containing the run matrix for the optimal design. The returned data frame contains supplementary
information in its attributes, which can be accessed with the `get_attributes()` and `get_optimality()` functions.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Split-plot designs can be generated with repeated applications of <code>gen_design</code>; see examples for details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Generate the basic factorial candidate set with expand.grid.</span></span></span>
<span class="r-in"><span><span class="co">#Generating a basic 2 factor candidate set:</span></span></span>
<span class="r-in"><span><span class="va">basic_candidates</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#This candidate set is used as an input in the optimal design generation for a</span></span></span>
<span class="r-in"><span><span class="co">#D-optimal design with 11 runs.</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span>candidateset <span class="op">=</span> <span class="va">basic_candidates</span>, model <span class="op">=</span> <span class="op">~</span><span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, trials <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#We can also use the dot formula to automatically use all of the terms in the model:</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span>candidateset <span class="op">=</span> <span class="va">basic_candidates</span>, model <span class="op">=</span> <span class="op">~</span><span class="va">.</span>, trials <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Here we add categorical factors, specified by using "as.factor" in expand.grid:</span></span></span>
<span class="r-in"><span><span class="va">categorical_candidates</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"High"</span>, <span class="st">"Med"</span>, <span class="st">"Low"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#This candidate set is used as an input in the optimal design generation.</span></span></span>
<span class="r-in"><span><span class="va">design2</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span>candidateset <span class="op">=</span> <span class="va">categorical_candidates</span>, model <span class="op">=</span> <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span>, trials <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#We can also increase the number of times the algorithm repeats</span></span></span>
<span class="r-in"><span><span class="co">#the search to increase the probability that the globally optimal design was found.</span></span></span>
<span class="r-in"><span><span class="va">design2</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span>candidateset <span class="op">=</span> <span class="va">categorical_candidates</span>,</span></span>
<span class="r-in"><span>                    model <span class="op">=</span> <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span>, trials <span class="op">=</span> <span class="fl">19</span>, repeats <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#We can perform a k-exchange algorithm instead of a full search to help speed up</span></span></span>
<span class="r-in"><span><span class="co">#the search process, although this can lead to less optimal designs. Here, we only</span></span></span>
<span class="r-in"><span><span class="co">#exchange the 10 lowest variance runs in each search iteration.</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu">skpr</span><span class="fu">:::</span><span class="fu"><a href="run_documentation.html">run_documentation</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">design_k</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span>candidateset <span class="op">=</span> <span class="va">categorical_candidates</span>,</span></span>
<span class="r-in"><span>                    model <span class="op">=</span> <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span>, trials <span class="op">=</span> <span class="fl">19</span>, repeats <span class="op">=</span> <span class="fl">100</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#To speed up the design search, you can turn on multicore support with the parallel option.</span></span></span>
<span class="r-in"><span><span class="co">#You can also customize the number of cores used by setting the cores option. By default,</span></span></span>
<span class="r-in"><span><span class="co">#all cores are used.</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu">skpr</span><span class="fu">:::</span><span class="fu"><a href="run_documentation.html">run_documentation</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">design2</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">categorical_candidates</span>,</span></span>
<span class="r-in"><span>                    model <span class="op">=</span> <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span>, trials <span class="op">=</span> <span class="fl">19</span>, repeats <span class="op">=</span> <span class="fl">1000</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: foreach</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: future</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#You can also use a higher order model when generating the design:</span></span></span>
<span class="r-in"><span><span class="va">design2</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">categorical_candidates</span>,</span></span>
<span class="r-in"><span>                    model <span class="op">=</span> <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span> <span class="op">+</span> <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">*</span> <span class="va">c</span>, trials <span class="op">=</span> <span class="fl">12</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#To evaluate a response surface design, include center points</span></span></span>
<span class="r-in"><span><span class="co">#in the candidate set and include quadratic effects (but not for the categorical factors).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">quad_candidates</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gen_design</span><span class="op">(</span><span class="va">quad_candidates</span>, <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">a</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">b</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">*</span> <span class="va">c</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     a  b c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  -1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  -1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   0  0 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   1  0 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 -1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 -1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  0 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 -1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 -1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 -1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  0  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 -1  0 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 -1 -1 A</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#The optimality criterion can also be changed:</span></span></span>
<span class="r-in"><span><span class="fu">gen_design</span><span class="op">(</span><span class="va">quad_candidates</span>, <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">a</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">b</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">*</span> <span class="va">c</span>, <span class="fl">20</span>,</span></span>
<span class="r-in"><span>          optimality <span class="op">=</span> <span class="st">"I"</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     a  b c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  -1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   0  0 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  -1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  -1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   0  0 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  0  0 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 -1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 -1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 -1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  0  0 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  0  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 -1  0 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  0 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  1  0 C</span>
<span class="r-in"><span><span class="fu">gen_design</span><span class="op">(</span><span class="va">quad_candidates</span>, <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">a</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">b</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">*</span> <span class="va">c</span>, <span class="fl">20</span>,</span></span>
<span class="r-in"><span>          optimality <span class="op">=</span> <span class="st">"A"</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     a  b c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   0  0 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  -1  0 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   0  0 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  -1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   0  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  0 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 -1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  0  0 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 -1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 -1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 -1  0 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  1  0 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 -1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  1  1 C</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#A blocked design can be generated by specifying the `blocksizes` argument. Passing a single</span></span></span>
<span class="r-in"><span><span class="co">#number will create designs with blocks of that size, while passing multiple values in a list</span></span></span>
<span class="r-in"><span><span class="co">#will specify multiple layers of blocking.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Specify a single layer</span></span></span>
<span class="r-in"><span><span class="fu">gen_design</span><span class="op">(</span><span class="va">quad_candidates</span>, <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span>, <span class="fl">21</span>, blocksizes<span class="op">=</span><span class="fl">3</span>, add_blocking_column<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Block1  a  b c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1 -1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       1  1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       1  1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       2  1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       2 -1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       2  1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       3 -1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       3  1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       3  1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      4 -1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      4 -1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      4  1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      5  1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      5 -1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      5  1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      6  1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      6 -1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      6 -1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      7  1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      7 -1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      7  1  1 B</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Manually specify the block sizes for a single layer, must add to `trials``</span></span></span>
<span class="r-in"><span><span class="fu">gen_design</span><span class="op">(</span><span class="va">quad_candidates</span>, <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span>, <span class="fl">21</span>, blocksizes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          add_blocking_column<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Block1  a  b c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1  1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       1 -1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       1 -1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       1  1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       2  1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       2 -1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       2  1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       3 -1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       3  1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      4  1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      4 -1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      4 -1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      5 -1 -1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      5 -1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      5  1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      6 -1 -1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      6  1  1 B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      6 -1  1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      7 -1  1 A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      7  1 -1 C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      7 -1  1 B</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Multiple layers of blocking</span></span></span>
<span class="r-in"><span><span class="fu">gen_design</span><span class="op">(</span><span class="va">quad_candidates</span>, <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span>, <span class="fl">21</span>, blocksizes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          add_blocking_column<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Block1 b  c NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1 1 -1  1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       1 1  1 -1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       1 1  1  1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       1 2 -1 -1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       1 2  1 -1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       1 2  1  1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       1 3 -1  1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       2 3 -1  1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       2 3  1 -1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      2 4  1  1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      2 4 -1 -1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      2 4  1  1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      2 5  1  1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      2 5 -1 -1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      3 5  1 -1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      3 6  1  1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      3 6 -1  1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      3 6  1 -1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      3 7 -1  1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      3 7  1  1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      3 7 -1 -1  B</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Multiple layers of blocking, specified individually</span></span></span>
<span class="r-in"><span><span class="fu">gen_design</span><span class="op">(</span><span class="va">quad_candidates</span>, <span class="op">~</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span>, <span class="fl">21</span>, blocksizes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          add_blocking_column<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Block1 b  c NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1 1 -1  1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       1 1  1 -1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       1 1 -1  1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       1 1  1 -1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       1 2  1  1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       1 2 -1 -1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       1 2  1  1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       2 3  1 -1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       2 3 -1  1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      2 4  1 -1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      2 4 -1  1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      2 4 -1 -1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      2 5 -1  1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      2 5  1 -1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      3 5 -1 -1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      3 6  1  1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      3 6 -1 -1  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      3 6  1  1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      3 7 -1 -1  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      3 7  1  1  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      3 7  1  1  B</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#A split-plot design can be generated by first generating an optimal blocking design using the</span></span></span>
<span class="r-in"><span><span class="co">#hard-to-change factors and then using that as the input for the split-plot design.</span></span></span>
<span class="r-in"><span><span class="co">#This generates an optimal subplot design that accounts for the existing split-plot settings.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">splitplotcandidateset</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Altitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                    Range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Close"</span>, <span class="st">"Medium"</span>, <span class="st">"Far"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                    Power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hardtochangedesign</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">splitplotcandidateset</span>, model <span class="op">=</span> <span class="op">~</span><span class="va">Altitude</span>,</span></span>
<span class="r-in"><span>                               trials <span class="op">=</span> <span class="fl">11</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Now we can use the D-optimal blocked design as an input to our full design.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Here, we add the easy to change factors from the candidate set to the model,</span></span></span>
<span class="r-in"><span><span class="co">#and input the hard-to-change design along with the new number of trials. `gen_design` will</span></span></span>
<span class="r-in"><span><span class="co">#automatically allocate the runs in the blocks in the most balanced way possible.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">designsplitplot</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">splitplotcandidateset</span>, <span class="op">~</span><span class="va">Altitude</span> <span class="op">+</span> <span class="va">Range</span> <span class="op">+</span> <span class="va">Power</span>, trials <span class="op">=</span> <span class="fl">33</span>,</span></span>
<span class="r-in"><span>                             splitplotdesign <span class="op">=</span> <span class="va">hardtochangedesign</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#If we want to allocate the blocks manually, we can do that with the argument `blocksizes`. This</span></span></span>
<span class="r-in"><span><span class="co">#vector must sum to the number of `trials` specified.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Putting this all together:</span></span></span>
<span class="r-in"><span><span class="va">designsplitplot</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">splitplotcandidateset</span>, <span class="op">~</span><span class="va">Altitude</span> <span class="op">+</span> <span class="va">Range</span> <span class="op">+</span> <span class="va">Power</span>, trials <span class="op">=</span> <span class="fl">33</span>,</span></span>
<span class="r-in"><span>                             splitplotdesign <span class="op">=</span> <span class="va">hardtochangedesign</span>,</span></span>
<span class="r-in"><span>                             blocksizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#The split-plot structure is encoded into the row names, with a period</span></span></span>
<span class="r-in"><span><span class="co">#demarcating the blocking level. This process can be repeated for arbitrary</span></span></span>
<span class="r-in"><span><span class="co">#levels of blocking (i.e. a split-plot design can be entered in as the hard-to-change</span></span></span>
<span class="r-in"><span><span class="co">#to produce a split-split-plot design, which can be passed as another</span></span></span>
<span class="r-in"><span><span class="co">#hard-to-change design to produce a split-split-split plot design, etc).</span></span></span>
<span class="r-in"><span><span class="co">#In the following, note that the model builds up as we build up split plot strata.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">splitplotcandidateset2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"East"</span>, <span class="st">"West"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     Climate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dry"</span>, <span class="st">"Wet"</span>, <span class="st">"Arid"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     Vineyard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     Age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#6 blocks of Location:</span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">splitplotcandidateset2</span>, <span class="op">~</span><span class="va">Location</span>, trials <span class="op">=</span> <span class="fl">6</span>, varianceratio <span class="op">=</span> <span class="fl">2</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>varianceratio cannot be set when split-plot design is not null.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Each Location block has 2 blocks of Climate:</span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">splitplotcandidateset2</span>, <span class="op">~</span><span class="va">Location</span> <span class="op">+</span> <span class="va">Climate</span>,</span></span>
<span class="r-in"><span>                  trials <span class="op">=</span> <span class="fl">12</span>, splitplotdesign <span class="op">=</span> <span class="va">temp</span>, blocksizes <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                  varianceratio <span class="op">=</span> <span class="fl">1</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Each Climate block has 4 blocks of Vineyard:</span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">splitplotcandidateset2</span>, <span class="op">~</span><span class="va">Location</span> <span class="op">+</span> <span class="va">Climate</span> <span class="op">+</span> <span class="va">Vineyard</span>,</span></span>
<span class="r-in"><span>                  trials <span class="op">=</span> <span class="fl">48</span>, splitplotdesign <span class="op">=</span> <span class="va">temp</span>, blocksizes <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                  varianceratio <span class="op">=</span> <span class="fl">1</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Each Vineyard block has 4 runs with different Age:</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu">skpr</span><span class="fu">:::</span><span class="fu"><a href="run_documentation.html">run_documentation</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">splitsplitsplitplotdesign</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">splitplotcandidateset2</span>, <span class="op">~</span><span class="va">Location</span> <span class="op">+</span> <span class="va">Climate</span> <span class="op">+</span> <span class="va">Vineyard</span> <span class="op">+</span> <span class="va">Age</span>,</span></span>
<span class="r-in"><span>                                       trials <span class="op">=</span> <span class="fl">192</span>, splitplotdesign <span class="op">=</span> <span class="va">temp</span>, blocksizes <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                                       varianceratio <span class="op">=</span> <span class="fl">1</span>, add_blocking_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co">#gen_design also supports user-defined optimality criterion. The user defines a function</span></span></span>
<span class="r-in"><span><span class="co">#of the model matrix named customOpt, and gen_design will attempt to generate a design</span></span></span>
<span class="r-in"><span><span class="co">#that maximizes that function. This function needs to be in the global environment, and be</span></span></span>
<span class="r-in"><span><span class="co">#named either customOpt or customBlockedOpt, depending on whether a split-plot design is being</span></span></span>
<span class="r-in"><span><span class="co">#generated. customBlockedOpt should be a function of the model matrix as well as the</span></span></span>
<span class="r-in"><span><span class="co">#variance-covariance matrix, vInv. Due to the underlying C + + code having to call back to the R</span></span></span>
<span class="r-in"><span><span class="co">#environment repeatedly, this criterion will be significantly slower than the built-in algorithms.</span></span></span>
<span class="r-in"><span><span class="co">#It does, however, offer the user a great deal of flexibility in generating their designs.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#We are going to write our own D-optimal search algorithm using base R functions. Here, write</span></span></span>
<span class="r-in"><span><span class="co">#a function that calculates the determinant of the information matrix. gen_design will search</span></span></span>
<span class="r-in"><span><span class="co">#for a design that maximizes this function.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">customOpt</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">currentDesign</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/det.html" class="external-link">det</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">currentDesign</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">currentDesign</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Generate the whole plots for our split-plot design, using the custom criterion.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">candlistcustom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Altitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">20000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            Range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Close"</span>, <span class="st">"Medium"</span>, <span class="st">"Far"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            Power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">htcdesign</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">candlistcustom</span>, model <span class="op">=</span> <span class="op">~</span><span class="va">Altitude</span> <span class="op">+</span> <span class="va">Range</span>,</span></span>
<span class="r-in"><span>                      trials <span class="op">=</span> <span class="fl">11</span>, optimality <span class="op">=</span> <span class="st">"CUSTOM"</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> Cannot convert object to a function: [type=NULL; target=CLOSXP, SPECIALSXP, or BUILTINSXP].</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Now define a function that is a function of both the model matrix,</span></span></span>
<span class="r-in"><span><span class="co">#as well as the variance-covariance matrix vInv. This takes the blocking structure into account</span></span></span>
<span class="r-in"><span><span class="co">#when calculating our determinant.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">customBlockedOpt</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">currentDesign</span>, <span class="va">vInv</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/det.html" class="external-link">det</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">currentDesign</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">vInv</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">currentDesign</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#And finally, calculate the design. This (likely) results in the same design had we chosen the</span></span></span>
<span class="r-in"><span><span class="co">#"D" criterion.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">candlistcustom</span>,</span></span>
<span class="r-in"><span>                   <span class="op">~</span><span class="va">Altitude</span> <span class="op">+</span> <span class="va">Range</span> <span class="op">+</span> <span class="va">Power</span>, trials <span class="op">=</span> <span class="fl">33</span>,</span></span>
<span class="r-in"><span>                   splitplotdesign <span class="op">=</span> <span class="va">htcdesign</span>, blocksizes <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                   optimality <span class="op">=</span> <span class="st">"CUSTOM"</span>, repeats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'htcdesign' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#gen_design can also augment an existing design. Input a dataframe of pre-existing runs</span></span></span>
<span class="r-in"><span><span class="co">#to the `augmentdesign` argument. Those runs in the new design will be fixed, and gen_design</span></span></span>
<span class="r-in"><span><span class="co">#will perform a search for the remaining `trials - nrow(augmentdesign)` runs.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">candidateset</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">55</span>, <span class="fl">65</span><span class="op">)</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">design_to_augment</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">candidateset</span>, <span class="op">~</span><span class="va">height</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">range</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#As long as the columns in the augmented design match the columns in the candidate set,</span></span></span>
<span class="r-in"><span><span class="co">#this design can be augmented.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">augmented_design</span> <span class="op">=</span> <span class="fu">gen_design</span><span class="op">(</span><span class="va">candidateset</span>,</span></span>
<span class="r-in"><span>                             <span class="op">~</span><span class="va">height</span> <span class="op">+</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">range</span>, <span class="fl">16</span>, augmentdesign <span class="op">=</span> <span class="va">design_to_augment</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#A design's diagnostics can be accessed via the `get_optimality()` function:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_optimality.html">get_optimality</a></span><span class="op">(</span><span class="va">augmented_design</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     D     I   A            G  T  E    Alias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 100 0.125 100 Not Computed 64 16 92111.39</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#And design attributes can be accessed with the `get_attribute()` function:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_attribute.html">get_attribute</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model.matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       (Intercept) x1 x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]           1  1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]           1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]           1 -1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]           1 -1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]           1 -1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]           1 -1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]           1 -1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]           1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]           1 -1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]           1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]           1  1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $moments.matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)        x1        x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)           1 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1                    0 0.3333333 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2                    0 0.0000000 0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $variance.matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1    0    0    0    0    0    0    0    0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    0    1    0    0    0    0    0    0    0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    0    0    1    0    0    0    0    0    0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    0    0    0    1    0    0    0    0    0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    0    0    0    0    1    0    0    0    0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    0    0    0    0    0    1    0    0    0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    0    0    0    0    0    0    1    0    0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    0    0    0    0    0    0    0    1    0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    0    0    0    0    0    0    0    0    1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    0    0    0    0    0    0    0    0    0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    0    0    0    0    0    0    0    0    0     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alias.matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             x1 x2      x1:x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  0  0  0.1111111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1           1  0  0.1111111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2           0  1 -0.1111111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $correlation.matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            x1         x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1 1.00000000 0.09090909</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2 0.09090909 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~x1 + x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5a2c3fc87320&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#A correlation color map can be produced by calling the plot_correlation command with the output</span></span></span>
<span class="r-in"><span><span class="co">#of gen_design()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu">skpr</span><span class="fu">:::</span><span class="fu"><a href="run_documentation.html">run_documentation</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_correlations.html">plot_correlations</a></span><span class="op">(</span><span class="va">design2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="gen_design-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#A fraction of design space plot can be produced by calling the plot_fds command</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu">skpr</span><span class="fu">:::</span><span class="fu"><a href="run_documentation.html">run_documentation</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_fds.html">plot_fds</a></span><span class="op">(</span><span class="va">design2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="gen_design-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Evaluating the design for power can be done with eval_design, eval_design_mc (Monte Carlo)</span></span></span>
<span class="r-in"><span><span class="co">#eval_design_survival_mc (Monte Carlo survival analysis), and</span></span></span>
<span class="r-in"><span><span class="co">#eval_design_custom_mc (Custom Library Monte Carlo)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Tyler Morgan-Wall, George Khoury.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

